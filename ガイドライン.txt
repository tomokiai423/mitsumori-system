================================================================================
GAS案件 自動見積もりシステム ガイドライン
================================================================================
作成日: 2025年12月17日
合同会社リバイラル システム開発事業部

================================================================================
【1】システム概要
================================================================================

■ このシステムは何？
「無料でシステム開発します」という集客用のお問い合わせフォームです。
AIが自動で工数を判定し、無料対応可能かどうかを自動返信します。

■ 主な機能
・お問い合わせフォーム（お客様が入力）
・AI自動工数判定（Claude APIを使用）
・自動返信メール（判定結果に応じて4パターン）
・Chatwork通知（新規問い合わせを通知）
・管理画面（問い合わせ一覧・ステータス管理）

================================================================================
【2】URL一覧
================================================================================

■ お問い合わせフォーム（お客様に公開するURL）
https://script.google.com/macros/s/AKfycbwpfhy8fkKfPHbegM7E7oANBKTz6lcmqYWmJcXNr2lTAFMocOza4Zop9szRpWMwsFiq/exec

■ 管理画面（社内用）
https://script.google.com/macros/s/AKfycbwpfhy8fkKfPHbegM7E7oANBKTz6lcmqYWmJcXNr2lTAFMocOza4Zop9szRpWMwsFiq/exec?page=admin

■ スプレッドシート（データ管理）
https://docs.google.com/spreadsheets/d/1A0QgC425A1yQDoZyg8ieB7sNPsyksH7b1uXrJeAJZL0/edit

================================================================================
【3】システムの流れ
================================================================================

1. お客様がフォームに入力して送信

2. システムが自動で判定
   ├─ NGフィルターチェック（スマホアプリ等は即NG）
   ├─ 規模感チェック（データ量・利用人数等で工数加算）
   └─ Claude AIが工数を計算

3. 判定結果
   ├─ OK（360分以下）→ 無料対応可能
   ├─ BORDERLINE（361〜480分）→ 要ヒアリング
   └─ NG（481分以上 or 技術制約）→ 対応不可

4. 自動処理
   ├─ スプレッドシートに記録
   ├─ お客様に自動返信メール
   └─ Chatworkに通知（OK/BORDERLINEの場合）

================================================================================
【4】管理画面の使い方
================================================================================

■ アクセス方法
上記の管理画面URLをブラウザで開く

■ 画面の説明
・上部：問い合わせ件数の統計（OK/要ヒアリング/対応不可）
・中央：フィルター（判定結果・ステータスで絞り込み）
・下部：問い合わせ一覧テーブル

■ ステータスの変更方法
1. 一覧の右端「ステータス」列のドロップダウンをクリック
2. 以下から選択：
   ・未対応 → まだ対応していない
   ・対応中 → 対応を進めている
   ・完了 → 対応完了
   ・見送り → 対応しないことに決定

================================================================================
【5】設定の変更方法
================================================================================

設定はスプレッドシートの「設定」シートで変更できます。
※コードの変更は不要です

■ 設定シートの開き方
1. スプレッドシートを開く
2. 下のタブから「設定」をクリック

■ 変更できる項目

┌─────────────────────┬─────────────────────────────────────┐
│ 項目                │ 説明                                │
├─────────────────────┼─────────────────────────────────────┤
│ CLAUDE_API_KEY      │ Claude APIのキー（変更不要）        │
├─────────────────────┼─────────────────────────────────────┤
│ 日程調整URL         │ Calendly等のURL                     │
│                     │ メールに記載されるリンク            │
├─────────────────────┼─────────────────────────────────────┤
│ Chatwork APIトークン│ Chatwork通知用（設定済み）          │
├─────────────────────┼─────────────────────────────────────┤
│ Chatwork ルームID   │ 通知先のルームID（設定済み）        │
├─────────────────────┼─────────────────────────────────────┤
│ 無料対応しきい値    │ この分数以下なら「OK」判定          │
│ （分）              │ 初期値: 360（6時間）                │
├─────────────────────┼─────────────────────────────────────┤
│ 要ヒアリングしきい値│ この分数以下なら「BORDERLINE」判定  │
│ （分）              │ 初期値: 480（8時間）                │
├─────────────────────┼─────────────────────────────────────┤
│ テストモード        │ TRUE: メール送信しない（テスト用）  │
│                     │ FALSE: メール送信する（本番用）     │
└─────────────────────┴─────────────────────────────────────┘

================================================================================
【6】テストモードと本番モード
================================================================================

■ テストモード（TRUE）
・メールは送信されない
・その他の機能（記録・通知・管理画面）は動作する
・フォームのテストや動作確認に使用

■ 本番モード（FALSE）
・メールが実際に送信される
・お客様に公開する前に設定

■ 切り替え方法
1. スプレッドシートの「設定」シートを開く
2.「テストモード」のB列を変更
   TRUE → FALSE（本番開始）
   FALSE → TRUE（テストに戻す）

================================================================================
【7】判定基準
================================================================================

■ NGフィルター（即時NG）
以下に該当すると、自動で「対応不可」になります：
・スマホアプリ（ネイティブ）が必要
・社外に一般公開するシステム
・既存システム（kintone、Salesforce等）の改修
・リアルタイム同期が必須（チャット、在庫同期等）
・Google Workspace外のユーザーも利用

■ 規模感による工数加算
┌─────────────────────────┬───────────┐
│ 条件                    │ 追加工数  │
├─────────────────────────┼───────────┤
│ データ量が1万行以上     │ +60分     │
│ 同時利用人数が数十人以上│ +45分     │
│ リアルタイム処理が必須  │ +90分     │
│ 大量データ移行あり      │ +60分     │
│ デザインにこだわりたい  │ +60分     │
│ 社外（取引先等）も利用  │ +45分     │
└─────────────────────────┴───────────┘

■ 判定結果
┌─────────────┬─────────────┬─────────────────────────┐
│ 判定        │ 工数        │ 対応                    │
├─────────────┼─────────────┼─────────────────────────┤
│ OK          │ 360分以下   │ 無料対応可能            │
│ BORDERLINE  │ 361〜480分  │ 要ヒアリング・機能削減  │
│ NG          │ 481分以上   │ 有料プラン案内          │
└─────────────┴─────────────┴─────────────────────────┘

================================================================================
【8】自動返信メールのパターン
================================================================================

■ パターンA: 無料対応OK
件名: 【無料対応可能】システム開発のお申込みありがとうございます
内容: 無料対応が可能です。日程調整URLからヒアリング予約をお願いします。

■ パターンB: 要ヒアリング
件名: 【ご相談】システム開発のお申込みについて
内容: 機能によっては無料対応が可能です。詳細をお伺いさせてください。

■ パターンC: 対応不可（工数オーバー）
件名: 【有料プランのご案内】システム開発のお申込みについて
内容: 無料対応の範囲を超えています。有料プランをご案内します。

■ パターンD: 対応不可（技術制約）
件名: 【ご案内】システム開発のお申込みについて
内容: 当サービスの対応範囲外となります。理由を記載。

※メール文面は「メールテンプレート」シートで変更可能

================================================================================
【9】メールテンプレートの変更方法
================================================================================

1. スプレッドシートを開く
2. 下のタブから「メールテンプレート」をクリック
3. 変更したい行のB列（件名）またはC列（本文）を編集

■ 使用できる変数（自動で置き換わる）
・{{会社名}} → お客様の会社名
・{{担当者名}} → お客様の担当者名
・{{日程調整URL}} → 設定シートのURL
・{{NG理由}} → 対応不可の理由

================================================================================
【10】トラブルシューティング
================================================================================

■ メールが届かない
→ 設定シートの「テストモード」が「TRUE」になっていないか確認
→「FALSE」になっていれば本番モード

■ Chatwork通知が届かない
→ 設定シートの「Chatwork APIトークン」と「ルームID」を確認
→ 判定結果が「NG」の場合は通知されない仕様

■ 管理画面にデータが表示されない
→ ブラウザを更新（F5キー）
→ 別のブラウザで試す

■ フォームでエラーが出る
→ Apps Scriptの権限が切れている可能性
→ システム管理者に連絡

================================================================================
【11】ファイル保存場所
================================================================================

システムのコードファイルは以下に保存されています：
C:\Users\music008\Documents\GAS見積もりシステム

■ ファイル一覧
・01_スプレッドシート初期設定.gs
・02_メインコード_v6.gs（最新版）
・03_フォーム.html
・04_Claude API連携.gs
・05_Chatwork通知_v2.gs（最新版）
・06_管理画面_v3.html（最新版）
・07_設定シート追加.gs
・08_テスト管理画面.html
・ガイドライン.txt（このファイル）

================================================================================
【12】問い合わせ先
================================================================================

システムについて不明点があれば、システム管理者にお問い合わせください。

================================================================================
以上
================================================================================
